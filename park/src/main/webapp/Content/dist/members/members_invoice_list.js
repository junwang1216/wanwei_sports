!function(e){var t={opts:{URL:"/member/getInvoices"},init:function(){this.initEvents()},initEvents:function(){var t=this;e(".ticket-filter").on("click",function(i){i.preventDefault();var o=e("#ticket_filter_form").serialize();location.assign(t.opts.URL+"?"+o)}),e(".page-first, .page-prev, .page-index, .page-next, .page-last").on("click",function(i){i.preventDefault();var o=location.search,n=e(this).attr("data-index");o?o.indexOf("page=")==-1?location.assign(t.opts.URL+"?"+o+"&page="+n):location.assign(t.opts.URL+"?"+o.replace(/(page=)\d+/,"$1"+n)):location.assign(t.opts.URL+"?page="+n)}),e(".invoice-list").on("click",".invoice-get-confirm",function(t){t.preventDefault();var i=e(this),o=i.attr("data-id");return"working"!=i.attr("working")&&(i.attr("working","working"),void e.post("/member/updateGetInvoices",{invoiceIds:o},function(t){i.attr("working",""),1==t.code?(e("#tips_message_modal").modal({backdrop:!1,show:!0}).find(".text-message").text("发票领取成功！"),setTimeout(function(){e("#tips_message_modal").modal("hide"),location.reload()},3e3)):(console.log(t.message||"发票领取状态改变失败, 请稍后重试"),alert(t.message||"发票领取状态改变失败, 请稍后重试"))}))}),e(".ticket-print").on("click",function(t){t.preventDefault();var i=e(this),o=e("[name='ticket_id']:checked");if(0===o.size())return alert("请选择已领取的发票");if("working"==i.attr("working"))return!1;i.attr("working","working");for(var n=[],a=0;a<o.size();a++)n.push(o.eq(a).val());e.post("/member/updateGetInvoices",{invoiceIds:n.join(",")},function(t){i.attr("working",""),1==t.code?(e("#tips_message_modal").modal({backdrop:!1,show:!0}).find(".text-message").text("发票领取成功！"),setTimeout(function(){e("#tips_message_modal").modal("hide"),location.reload()},3e3)):(console.log(t.message||"发票领取状态改变失败, 请稍后重试"),alert(t.message||"发票领取状态改变失败, 请稍后重试"))})}),e(".invoice-list").on("click",".invoice-open-confirm",function(t){t.preventDefault();var i=e(this),o=i.attr("data-id");return"working"!=i.attr("working")&&(i.attr("working","working"),void e.post("/member/updateOpenInvoices",{invoiceIds:o},function(t){i.attr("working",""),1==t.code?(e("#tips_message_modal").modal({backdrop:!1,show:!0}).find(".text-message").text("发票开具成功！"),setTimeout(function(){e("#tips_message_modal").modal("hide"),location.reload()},3e3)):(console.log(t.message||"发票开具状态改变失败, 请稍后重试"),alert(t.message||"发票开具状态改变失败, 请稍后重试"))}))}),e(".ticket-open").on("click",function(t){t.preventDefault();var i=e(this),o=e("[name='ticket_id']:checked");if(0===o.size())return alert("请选择已开具的发票");if("working"==i.attr("working"))return!1;i.attr("working","working");for(var n=[],a=0;a<o.size();a++)n.push(o.eq(a).val());e.post("/member/updateOpenInvoices",{invoiceIds:n.join(",")},function(t){i.attr("working",""),1==t.code?(e("#tips_message_modal").modal({backdrop:!1,show:!0}).find(".text-message").text("发票开具成功！"),setTimeout(function(){e("#tips_message_modal").modal("hide"),location.reload()},3e3)):(console.log(t.message||"发票开具状态改变失败, 请稍后重试"),alert(t.message||"发票开具状态改变失败, 请稍后重试"))})})}};t.init()}(jQuery);