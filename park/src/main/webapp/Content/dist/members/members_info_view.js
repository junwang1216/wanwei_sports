!function(e){var t={init:function(){this.initEvents(),e.datetimepicker.setLocale("zh"),e("#member_birthday").datetimepicker({timepicker:!1,lang:"zh",format:"Y-m-d",defaultDate:new Date}),e(".member-birthday-select").on("click",function(t){t.preventDefault(),e("#member_birthday").datetimepicker("show")}),e.post("member/getNewCardNo",function(t){var a=t.data;1==t.code?e("#newCardNo").val(a.newCardNo):(console.log(t.message||"新会员卡号生成失败, 请稍后重试"),alert(t.message||"新会员卡号生成失败, 请稍后重试"))},"json")},calculateRechargeMoney:function(){var t=e("#recharge_money"),a=e("#recharge_send"),r=parseFloat(t.val()||"0.00"),n=parseFloat(a.val()||"0.00");return(r+n).toFixed(2)},calculateRefreshMoney:function(){var t=e("#refresh_money"),a=e("#refresh_send"),r=parseFloat(t.val()||"0.00"),n=parseFloat(a.val()||"0.00");return(r+n).toFixed(2)},initEvents:function(){function t(t){e.post("member/getMemberCarType",{cardTypeId:t},function(t){var a=t.data;1==t.code?(e("#upgrade_cost").val(a.cardTypeMoney),e("#upgrade_discount").val(a.cardTypeDiscount),e("#upgrade_deadline").val(a.cardDeadline)):alert(t.message||"卡类型信息查询失败, 请稍后重试")})}var a=this;e(".gengxin-modal").on("click",function(t){t.preventDefault();var a=e("#member_form"),r=a.serialize();return!("submitting"==a.attr("submitting")||!a.valid())&&(a.attr("submitting","submitting"),void e.post("/member/saveMember",r,function(t){a.attr("submitting",""),1==t.code?(e("#gengxinModal").modal({backdrop:!1,show:!0}),setTimeout(function(){e("#gengxinModal").modal("hide")},3e3)):(console.log(t.message||"会员信息更新失败, 请稍后重试"),alert(t.message||"会员信息更新失败, 请稍后重试"))}))}),e("#recharge_money, #recharge_send").on("change",function(t){t.preventDefault(),e(".recharge-total-money").text(a.calculateRechargeMoney())}),e("#refresh_money, #refresh_send").on("change",function(t){t.preventDefault(),e(".refresh-total-money").text(a.calculateRefreshMoney())}),e(".recharge-card-submit").on("click",function(t){t.preventDefault();var a=e(".recharge-card-form"),r=a.serialize();return!("submitting"==a.attr("submitting")||!a.valid())&&(a.attr("submitting","submitting"),void e.post("/member/memberCardCZ",r,function(e){a.attr("submitting",""),1==e.code?location.reload():(console.log(e.message||"会员充值失败, 请稍后重试"),alert(e.message||"会员充值失败, 请稍后重试"))}))}),e(".refresh-card-submit").on("click",function(t){t.preventDefault();var a=e(".refresh-card-form"),r=a.serialize();return!("submitting"==a.attr("submitting")||!a.valid())&&(a.attr("submitting","submitting"),void e.post("/member/memberCardBuBan",r,function(e){a.attr("submitting",""),1==e.code?location.reload():alert(e.message||"会员补办失败, 请稍后重试")}))}),e(".shengji-modal").on("click",function(a){a.preventDefault();var r=e('[name="cardTypeId"]').val();t(r)}),e("[name='cardTypeId']").on("change",function(a){a.preventDefault();var r=e(this).val();t(r)}),e(".upgrade-card-submit").on("click",function(t){t.preventDefault();var a=e(".upgrade-card-form"),r=a.serialize();return!("submitting"==a.attr("submitting")||!a.valid())&&(a.attr("submitting","submitting"),void e.post("member/memberCardUpLevel",r,function(e){a.attr("submitting",""),1==e.code?location.reload():alert(e.message||"会员升级失败, 请稍后重试")}))})}};t.init()}(jQuery);