!function(e){var t={opts:{ToURL:"/member/memberList"},init:function(){e.post("/member/getMemberCarType",{cardTypeId:e('[name="cardTypeId"]').val()},function(t){if(1==t.code){var a=t.data;e('[name="cardTypeMoney"]').val(a.cardTypeMoney||"0.00"),e('[name="cardDeadline"]').val(a.cardDeadline),e('[name="cardDeposit"]').val(a.cardDeposit||"0.00")}else alert(t.message||"会员类别详情查询失败, 请稍后重试")}),this.initEvents()},calculateMoney:function(){var t=e("#recharge_money"),a=e("#recharge_send"),i=e("#recharge_type_money"),n=e("#recharge_type_deposit"),r=parseFloat(t.val()||"0.00"),o=parseFloat(a.val()||"0.00"),s=parseFloat(i.val()),c=parseFloat(n.val());return(r+o-s-c).toFixed(2)},initEvents:function(){var t=this;e(".genxin-submit").on("click",function(t){t.preventDefault();var a=e("#member_form"),i=a.serialize();return!("submitting"==a.attr("submitting")||!a.valid())&&(a.attr("submitting","submitting"),void e.post("/member/updateMemberName",i,function(t){a.attr("submitting",""),1==t.code?(e("#tips_modal").modal({backdrop:!1,show:!0}),setTimeout(function(){e("#tips_modal").modal("hide")},3e3)):(console.log(t.message||"会员信息更新失败, 请稍后重试"),alert(t.message||"会员信息更新失败, 请稍后重试"))}))}),e("#recharge_money, #recharge_send").on("change",function(a){a.preventDefault(),e(".total-money").text(t.calculateMoney())}),e(".register-recahrge").on("click",function(t){t.preventDefault();var a=e("#member_card_form"),i=a.serialize();return!("submitting"==a.attr("submitting")||!a.valid())&&(a.attr("submitting","submitting"),void e.post("/member/saveMemberCar",i,function(t){a.attr("submitting",""),1==t.code?(e("#confirm_modal").modal({backdrop:!1,show:!0}),e.each(t.data,function(t,a){e("#member_card_ticket_form").find("input[name='"+t+"']").val(a)})):(console.log(t.message||"会员卡充值失败, 请稍后重试"),alert(t.message||"会员卡充值失败, 请稍后重试"))}))}),e("#is_print_ticket").on("change",function(t){t.preventDefault();var a=e(this).prop("checked");a?e(".is-show-ticket").show():e(".is-show-ticket").hide()}),e(".print-ticket").on("click",function(a){if(a.preventDefault(),!e("#is_print_ticket").prop("checked"))return location.assign(t.opts.ToURL),e("#confirmModal").modal({backdrop:!1,show:!1}),!1;var i=e("#member_card_ticket_form"),n=i.serialize();return!("submitting"==i.attr("submitting")||!i.valid())&&(i.attr("submitting","submitting"),void e.post("/member/saveInvoice",n,function(a){i.attr("submitting",""),1==a.code?(location.assign(t.opts.ToURL),e("#confirmModal").modal({backdrop:!1,show:!1})):alert(a.message||"打印流水单失败, 请稍后重试")}))})}};t.init()}(jQuery);