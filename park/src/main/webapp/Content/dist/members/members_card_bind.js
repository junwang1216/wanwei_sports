!function(t){var e={opts:{ToURL:"/member/memberList"},init:function(){this.initEvents()},initEvents:function(){var e=this;t(".genxin-submit").on("click",function(e){e.preventDefault();var i=t("#member_form"),a=i.serialize();return!("submitting"==i.attr("submitting")||!i.valid())&&(i.attr("submitting","submitting"),void t.post("/member/updateMemberName",a,function(e){i.attr("submitting",""),1==e.code?t("#tips_modal").modal({backdrop:!1,show:!0}):alert(e.message||"会员信息更新失败, 请稍后重试")}))}),t("#member_type").on("change",function(e){e.preventDefault(),t.post("/member/getMemberCarType",{cardTypeId:t(this).val()},function(e){if(1==e.code){var i=e.data;t('[name="cardTypeDiscount"]').val(i.cardTypeDiscount+"折"),t('[name="cardTypeCredit"]').val((i.cardTypeCredit||0)+"元"),t('[name="cardTypeMoney"]').val((i.cardTypeMoney||0)+"元"),t('[name="cardDeadline"]').val(i.cardDeadline),t('[name="cardTypeAhead"]').val((i.cardTypeAhead||0)+"天")}else alert(e.message||"会员类别详情查询失败, 请稍后重试")})}),t(".register-recahrge").on("click",function(e){e.preventDefault();var i=t("#member_card_form"),a=i.serialize();return!("submitting"==i.attr("submitting")||!i.valid())&&(i.attr("submitting","submitting"),void t.post("/member/saveMemberCar",a,function(e){i.attr("submitting",""),1==e.code?(t("#confirm_modal").modal({backdrop:!1,show:!0}),t.each(e.data,function(e,i){t("#member_card_ticket_form").find("input[name='"+e+"']").val(i)})):alert(e.message||"会员卡充值失败, 请稍后重试")}))}),t("#is_print_ticket").on("change",function(e){e.preventDefault();var i=t(this).prop("checked");i?t(".is-show-ticket").show():t(".is-show-ticket").hide()}),t(".print-ticket").on("click",function(i){if(i.preventDefault(),!t("#is_print_ticket").prop("checked"))return location.assign(e.opts.ToURL),t("#confirmModal").modal({backdrop:!1,show:!1}),!1;var a=t("#member_card_ticket_form"),n=a.serialize();return!("submitting"==a.attr("submitting")||!a.valid())&&(a.attr("submitting","submitting"),void t.post("/member/saveInvoice",n,function(i){a.attr("submitting",""),1==i.code?(location.assign(e.opts.ToURL),t("#confirmModal").modal({backdrop:!1,show:!1})):alert(i.message||"打印流水单失败, 请稍后重试")}))})}};e.init()}(jQuery);