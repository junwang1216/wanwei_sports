!function(e){var t={opts:{ToURL:"/member/memberList"},init:function(){e.post("/member/getMemberCarType",{cardTypeId:e('[name="cardTypeId"]').val()},function(t){if(1==t.code){var i=t.data;e('[name="cardTypeMoney"]').val(i.cardTypeMoney||"0.00"),e('[name="cardDeadline"]').val(i.cardDeadline),e('[name="cardDeposit"]').val(i.cardDeposit||"0.00")}else alert(t.message||"会员类别详情查询失败, 请稍后重试")}),this.initEvents()},calculateMoney:function(){var t=e("#recharge_money"),i=e("#recharge_send"),a=e("#recharge_type_money"),r=e("#recharge_type_deposit"),n=parseFloat(t.val()||"0.00"),o=parseFloat(i.val()||"0.00"),c=parseFloat(a.val()),m=parseFloat(r.val());return(n+o-c-m).toFixed(2)},initEvents:function(){var t=this;e(".genxin-submit").on("click",function(t){t.preventDefault();var i=e("#member_form"),a=i.serialize();return!("submitting"==i.attr("submitting")||!i.valid())&&(i.attr("submitting","submitting"),void e.post("/member/updateMemberName",a,function(t){i.attr("submitting",""),1==t.code?(e("#tips_modal").modal({backdrop:!1,show:!0}),setTimeout(function(){e("#tips_modal").modal("hide")},3e3)):(console.log(t.message||"会员信息更新失败, 请稍后重试"),alert(t.message||"会员信息更新失败, 请稍后重试"))}))}),e("#recharge_money, #recharge_send").on("change",function(i){i.preventDefault(),e(".total-money").text(t.calculateMoney())}),e(".register-recahrge").on("click",function(t){t.preventDefault();var i=e("#member_card_form"),a=i.serialize();return!("submitting"==i.attr("submitting")||!i.valid())&&(i.attr("submitting","submitting"),void e.post("/member/saveMemberCar",a,function(t){i.attr("submitting",""),1==t.code?(e("#confirm_modal").modal({backdrop:!1,show:!0}),e.each(t.data,function(t,i){e("#member_card_ticket_form").find("input[name='"+t+"']").val(i)}),e("#member_card_ticket_form").find("#ticket_header").val(""),e("#member_card_ticket_form").find("#ticket_money").val(""),e("#member_card_ticket_form").find("#ticket_content").val("")):(console.log(t.message||"会员卡充值失败, 请稍后重试"),alert(t.message||"会员卡充值失败, 请稍后重试"))}))}),e("#is_print_ticket").on("change",function(t){t.preventDefault();var i=e(this).prop("checked");i?e(".is-show-ticket").show():e(".is-show-ticket").hide()}),e(".print-ticket").on("click",function(i){if(i.preventDefault(),!e("#is_print_ticket").prop("checked"))return location.assign(t.opts.ToURL),e("#confirmModal").modal("hide"),!1;var a=e("#member_card_ticket_form"),r=a.serialize();return!("submitting"==a.attr("submitting")||!a.valid())&&(a.attr("submitting","submitting"),void e.post("/member/saveInvoice",r,function(i){a.attr("submitting",""),1==i.code?(location.assign(t.opts.ToURL),e("#confirmModal").modal("hide")):alert(i.message||"发票登记失败, 请稍后重试")}))})}};t.init()}(jQuery);