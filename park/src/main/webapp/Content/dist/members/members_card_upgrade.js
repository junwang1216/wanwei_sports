!function(e){var r={init:function(){this.initEvents()},initEvents:function(){function r(r){e.post("/member/getMemberCarType",{cardTypeId:r},function(r){var a=r.data;1==r.code?(e("#upgrade_cost").val(a.cardTypeMoney+"元"),e("#upgrade_discount").val(a.cardTypeDiscount+"折"),e("#upgrade_deadline").val(a.cardDeadline)):alert("卡类型信息查询失败, 请稍后重试")})}e("#keywords").autosuggest({url:"/member/searchMember",method:"post",queryParamName:"search",dataCallback:function(e){var r=e.data,a=[];if(1==e.code){if(r&&r.members&&r.members.length>0){for(var t=0;t<r.members.length;t++)a.push({id:r.members[t].memberId,label:r.members[t].cardNo,value:r.members[t].memberName+"("+r.members[t].memberMobile+","+r.members[t].cardNo+")"});return a}return alert("没有搜索到会员"),[]}return alert("搜索会员失败, 请稍后重试"),[]},onSelect:function(r){var a=r.data("label");e("#card_no").val(a),location.assign("/member/getMembersCardUpgrade?cardNo="+a)}}),e(".member-card-filter").on("click",function(r){r.preventDefault();var a=e("#member_card_form"),t=a.serialize();return!!a.valid()&&void e.post("member/searchMember",t,function(e){var r=e.data;1==e.code?r&&r.members&&r.members.length>0?location.assign("/member/getMembersCardUpgrade?cardNo="+r.members[0].cardNo):alert("没有搜索到会员"):alert("搜索会员失败, 请稍后重试")})}),e("[name='cardTypeId']").on("change",function(a){a.preventDefault();var t=e(this).val();r(t)}),e("[name='cardTypeId']").change(),e(".upgrade-card-submit").on("click",function(r){r.preventDefault();var a=e("#upgrade_card_form"),t=a.serialize();return""===e("#upgrade_cardId").val()?(alert("请先选择会员卡"),!1):!("submitting"==a.attr("submitting")||!a.valid())&&(a.attr("submitting","submitting"),void e.post("/member/memberCardUpLevel",t,function(e){a.attr("submitting",""),1==e.code?alert("会员升级成功"):alert("会员升级失败, 请稍后重试")}))})}};r.init()}(jQuery);