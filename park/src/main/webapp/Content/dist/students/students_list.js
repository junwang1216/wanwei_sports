!function(t){var e={opts:{URL:"/students/list"},init:function(){this.initEvents()},initEvents:function(){var e=this;t(".student-filter").on("click",function(a){a.preventDefault();var n=t("#student_filter_form").serialize();location.assign(e.opts.URL+"?"+n)}),t(".page-first, .page-prev, .page-index, .page-next, .page-last").on("click",function(a){a.preventDefault();var n=location.search,s=t(this).attr("data-index");n?n.indexOf("page=")==-1?location.assign(e.opts.URL+"?"+n+"&page="+s):location.assign(e.opts.URL+"?"+n.replace(/(page=)\d+/,"$1"+s)):location.assign(e.opts.URL+"?page="+s)}),t(".students-list").on("click",".students-refresh",function(){var e=t(this);t("#refresh_cardId").val(e.attr("data-cardId")),t("#refresh_cardNo").val(e.attr("data-cardNo")),t.post("/member/getNewCardNo",function(e){var a=e.data;1==e.code?t("#refresh_newNo").val(a.newCardNo).attr("readonly","readonly"):(console.log(e.message||"新会员卡号生成失败, 请稍后重试"),alert(e.message||"新会员卡号生成失败, 请稍后重试"))})}),t(".confirm-refresh").on("click",function(e){e.preventDefault();var a=t("#refresh_form"),n=a.serialize();return""===t("#refresh_cardId").val()?(alert("请先选择会员卡"),!1):!("submitting"==a.attr("submitting")||!a.valid())&&(a.attr("submitting","submitting"),void t.post("/students/studentCardBuBan",n,function(e){a.attr("submitting",""),1==e.code?(t("#refreshModal").modal({backdrop:!1,show:!0}),setTimeout(function(){t("#refreshModal").modal("hide"),location.reload()},3e3)):(console.log(e.message||"学生卡补办失败, 请稍后重试"),alert(e.message||"学生卡补办失败, 请稍后重试"))}))}),t(".students-list").on("click",".students-delete",function(){var e=t(this);t("#delete_studentId").val(e.attr("data-id")),t("#deleteModal").modal({backdrop:!1,show:!0})}),t(".confirm-delete").on("click",function(e){e.preventDefault();var a=t("#delete_studentId").val();t.post("/students/lockStudent",{studentId:a},function(t){1==t.code?location.reload():(console.log(t.message||"学生删除失败, 请稍后重试"),alert(t.message||"学生删除失败, 请稍后重试"))})})}};e.init()}(jQuery);