!function(t){var e={opts:{URL:"/students/list"},init:function(){this.initEvents()},initEvents:function(){var e=this;t(".student-filter").on("click",function(n){n.preventDefault();var a=t("#student_filter_form").serialize();location.assign(e.opts.URL+"?"+a)}),t(".page-first, .page-prev, .page-index, .page-next, .page-last").on("click",function(n){n.preventDefault();var a=location.search,s=t(this).attr("data-index");a?a.indexOf("page=")==-1?location.assign(e.opts.URL+"?"+a+"&page="+s):location.assign(e.opts.URL+"?"+a.replace(/(page=)\d+/,"$1"+s)):location.assign(e.opts.URL+"?page="+s)}),t(".students-list").on("click",".students-refresh",function(){var e=t(this);t("#refresh_cardId").val(e.attr("data-cardId")),t("#refresh_cardNo").val(e.attr("data-cardNo")),t.post("/students/getNewCardNo",function(e){var n=e.data;1==e.code?t("#refresh_newNo").val(n.newCardNo):(t.logConsole("新会员卡号生成失败",e.message),t.tipsWarningAlert("新会员卡号生成失败"))})}),t(".confirm-refresh").on("click",function(e){e.preventDefault();var n=t(this).button("loading"),a=t("#refresh_form"),s=a.serialize();return""===t("#refresh_cardId").val()?(alert("请先选择会员卡"),!1):!("submitting"==a.attr("submitting")||!a.valid())&&(a.attr("submitting","submitting"),void t.post("/students/studentCardBuBan",s,function(e){a.attr("submitting",""),1==e.code?t.tipsSuccessAlert("学生卡补办成功！",function(){location.reload()}):(t.logConsole("学生卡补办失败",e.message),t.tipsWarningAlert("学生卡补办失败")),n.button("reset")}))}),t(".students-list").on("click",".students-delete",function(){var e=t(this);t("#delete_studentId").val(e.attr("data-id")),t("#delete_modal").modal({backdrop:!1,show:!0})}),t(".confirm-delete").on("click",function(e){e.preventDefault();var n=t("#delete_studentId").val();t.post("/students/lockStudent",{studentId:n},function(e){1==e.code?location.reload():(t.logConsole("学生删除失败",e.message),t.tipsWarningAlert("学生删除失败"))})})}};e.init()}(jQuery);