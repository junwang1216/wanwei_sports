!function(t){var n={opts:{URL:"/office/notifications",RECEIVER_TPL:'<button type="button" class="btn btn-info note-receiver" data-id="#RECEIVERID#" style="margin: 6px">#RECEIVERNAME# <span class="glyphicon glyphicon-remove text-danger remove"></span></button>'},init:function(){this.initEvents()},initEvents:function(){function n(n,i){2==i?(t("#fasongModal").find("#note_receiver1").val(n.noteReceiver).attr("disabled","disabled"),t("#fasongModal").find(".note-title").text(n.noteTitle).attr("disabled","disabled"),t("#fasongModal").find(".note-content").text(n.noteContent).attr("disabled","disabled"),t("#fasongModal").find(".send-notification").hide(),t("#fasongModal").find(".resend-notification").show()):(t("#fasongModal").find("#note_id").val(n.noteId),t("#fasongModal").find("#note_receiver").val(n.noteReceiver),t("#fasongModal").find("#note_title").val(n.noteTitle),t("#fasongModal").find("#note_content").val(n.noteContent),t("#fasongModal").find(".send-notification").show(),t("#fasongModal").find(".resend-notification").hide())}var i=this;t(".notification-filter").on("click",function(n){n.preventDefault();var e=t("#notification_filter_form").serialize();location.assign(i.opts.URL+"?"+e)}),t(".page-first, .page-prev, .page-index, .page-next, .page-last").on("click",function(n){n.preventDefault();var e=location.search,o=t(this).attr("data-index");e?e.indexOf("page=")==-1?location.assign(i.opts.URL+"?"+e+"&page="+o):location.assign(i.opts.URL+"?"+e.replace(/(page=)\d+/,"$1"+o)):location.assign(i.opts.URL+"?page="+o)}),t(".add-notification").on("click",function(t){t.preventDefault(),n({},1)}),t(".note-receivers").on("click",".note-receiver .remove",function(n){n.preventDefault();var i=t(this);i.parents(".note-receiver").remove()}),t(".send-notification").on("click",function(n){n.preventDefault();var i=t("#notification_form"),e=i.serializeObject();return!("submitting"===i.attr("submitting")||!i.valid())&&(i.attr("submitting","submitting"),void t.post("office/sendNotifications",e,function(t){i.attr("submitting",""),1==t.code?location.reload():(console.log(t.message||"通知信息发送失败, 请稍后重试"),alert(t.message||"通知信息发送失败, 请稍后重试"))}))}),t(".notifications-list").on("click",".notifications-view",function(i){i.preventDefault();var e=t(this).attr("data-id");t.post("office/viewNotifications",{noteId:e},function(t){var i=t.data;1==t.code?n(i,2):(console.log(t.message||"查询通知详情失败, 请稍后重试"),alert(t.message||"查询通知详情失败, 请稍后重试"))})}),t(".notifications-list").on("click",".notifications-resend",function(i){i.preventDefault();var e=t(this).attr("data-id"),o=t(this).attr("data-edit");t.post("office/viewNotifications",{noteId:e},function(i){var e=i.data;1==i.code?(n(e,o),1==o&&(t("#fasongModal").find(".save-notification").hide(),t("#fasongModal").find(".send-notification").send())):(console.log(i.message||"查询通知详情失败, 请稍后重试"),alert(i.message||"查询通知详情失败, 请稍后重试"))})})}};n.init()}(jQuery);