!function(i){var t={opts:{URL:location.pathname,RECEIVER_TPL:'<button type="button" class="btn btn-info note-receiver" data-id="#RECEIVERID#" style="margin: 6px">#RECEIVERNAME# <span class="glyphicon glyphicon-remove text-danger remove"></span></button>'},init:function(){this.initEvents()},initEvents:function(){function t(t,n){2==n?(i("#notifications_send_modal").find("#notification_send_id").val(t.noteId),i("#notifications_send_modal").find("#notification_send_receiver").val(t.noteReceiver||""),i("#notifications_send_modal").find("#notification_send_title").val(t.noteTitle||""),i("#notifications_send_modal").find("#notification_send_content").val(t.noteContent||"")):(i("#notifications_view_modal").find("#notification_view_id").val(t.noteId),i("#notifications_view_modal").find("#notification_view_receiver").val(t.noteReceiver||""),i("#notifications_view_modal").find("#notification_view_title").val(t.noteTitle||""),i("#notifications_view_modal").find("#notification_view_content").val(t.noteContent||""))}var n=this;i(".notification-filter").on("click",function(t){t.preventDefault();var e=i("#notification_filter_form").serialize();location.assign(n.opts.URL+"?"+e)}),i(".page-first, .page-prev, .page-index, .page-next, .page-last").on("click",function(t){t.preventDefault();var e=location.search,o=i(this).attr("data-index");e?e.indexOf("page=")==-1?location.assign(n.opts.URL+"?"+e+"&page="+o):location.assign(n.opts.URL+"?"+e.replace(/(page=)\d+/,"$1"+o)):location.assign(n.opts.URL+"?page="+o)}),i(".add-notification").on("click",function(i){i.preventDefault(),t({},1)}),i("#notification_view_receiver").on("change",function(i){return i.preventDefault(),!1}),i(".note-view-receivers").on("click",".note-receiver .remove",function(t){t.preventDefault();var n=i(this);n.parents(".note-receiver").remove()}),i(".send-notification").on("click",function(t){t.preventDefault();var e=i("#notification_send_form"),o=e.serializeObject();return!("submitting"===e.attr("submitting")||!e.valid())&&(e.attr("submitting","submitting"),void i.post("office/sendNotifications",o,function(t){e.attr("submitting",""),1==t.code?location.assign(n.opts.URL+"?type=2"):(i.logConsole("通知信息发送失败",t.message),i.tipsWarningAlert("通知信息发送失败"))}))}),i(".save-notification").on("click",function(t){t.preventDefault();var n=i("#notification_view_form"),e=n.serializeObject();return!("submitting"===n.attr("submitting")||!n.valid())&&(n.attr("submitting","submitting"),void i.post("office/saveNotifications",e,function(t){n.attr("submitting",""),1==t.code?location.reload():(i.logConsole("通知详情保存失败",t.message),i.tipsWarningAlert("通知详情保存失败"))}))}),i(".notifications-list").on("click",".notifications-view",function(n){n.preventDefault();var e=i(this).attr("data-id");i.post("office/viewNotifications",{noteId:e},function(n){var e=n.data;1==n.code?t(e,1):(i.logConsole("查询通知详情失败",n.message),i.tipsWarningAlert("通知详情查询失败"))})}),i(".notifications-list").on("click",".notifications-send",function(n){n.preventDefault();var e=i(this).attr("data-id");i.post("office/viewNotifications",{noteId:e},function(n){var e=n.data;1==n.code?t(e,2):(i.logConsole("查询通知详情失败",n.message),i.tipsWarningAlert("通知详情查询失败"))})}),i(".notifications-list").on("click",".notifications-delete",function(t){t.preventDefault();var n=i(this).attr("data-id");i.post("office/deleteNotifications",{noteId:n},function(t){1==t.code?(i.tipsWarningAlert("通知消息删除成功！"),setTimeout(function(){location.reload()},2e3)):(i.logConsole("查询通知详情失败",t.message),i.tipsWarningAlert("通知详情查询失败"))})})}};t.init()}(jQuery);