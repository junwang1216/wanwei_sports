!function(e){var t={opts:{URL:"/office/schedule"},init:function(){e.datetimepicker.setLocale("zh"),e("#user_schedule_date").datetimepicker({timepicker:!1,lang:"zh",format:"Y-m-d",defaultDate:new Date,minDate:0}),e("#user_schedule_start").datetimepicker({datepicker:!1,format:"H:i",step:30,value:"06:00"}),e("#user_schedule_end").datetimepicker({datepicker:!1,format:"H:i",step:30,value:"22:00"}),this.initEvents()},initEvents:function(){function t(t){e("#schedule_modal").find("#user_schedule_id").val(t.schedulingId||""),e("#schedule_modal").find("#user_schedule_date").val(t.date||""),e("#schedule_modal").find("#user_schedule_start").val(t.startTime||""),e("#schedule_modal").find("#user_schedule_end").val(t.endTime||""),e("#schedule_modal").find("#user_schedule_operator").val(t.operatorId||""),e("#schedule_modal").find("#user_schedule_job").val(t.schedulingJob||""),t.schedulingId?e("#user_schedule_delete").show():e("#user_schedule_delete").hide()}var d=this;e(".data-filter").on("click",function(t){t.preventDefault();var i=e("#data_form").serialize();location.assign(d.opts.URL+"?"+i)}),e(".add-schedule").on("click",function(e){e.preventDefault(),t({})}),e(".edit-schedule").on("click",function(d){d.preventDefault();var i=e(this).attr("data-id");e.post("office/scheduleInfo",{schedulingId:i},function(e){var d=e.data;1==e.code?t(d):(console.log(e.message||"查询值班详情失败, 请稍后重试"),alert(e.message||"查询值班详情失败, 请稍后重试"))})}),e("#user_schedule_submit").on("click",function(t){t.preventDefault();var d=e("#user_schedule_form"),i=d.serialize();return!("submitting"===d.attr("submitting")||!d.valid())&&(d.attr("submitting","submitting"),void e.post("office/saveSchedule",i,function(t){d.attr("submitting",""),1==t.code?(e("#tips_modal").modal({backdrop:!1,show:!0}),setTimeout(function(){e("#tips_modal").modal("hide"),location.reload()},3e3)):alert(t.message||"值班信息保存失败, 请稍后重试")}))}),e("#user_schedule_delete").on("click",function(t){t.preventDefault(),e.post("office/deleteSchedule",{schedulingId:e("#user_schedule_id").val()},function(e){1==e.code?location.reload():alert(e.message||"值班信息删除失败, 请稍后重试")})}),e(".schedule-day").on("click",".panel-heading",function(t){t.preventDefault();var d=e(this),i=d.parents(".schedule-day");i.find(".schedule-list").is(":hidden")?i.find(".schedule-list").show():i.find(".schedule-list").hide()})}};t.init()}(jQuery);