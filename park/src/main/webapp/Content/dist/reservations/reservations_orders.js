!function(e){var a={opts:{URL:"/order/getOrderList?orderServiceTypes=100,200"},init:function(){this.initEvents(),this.changePaidMoney()},initEvents:function(){var a=this;e(".orders-filter").on("click",function(r){r.preventDefault();var t=e("#orders_filter_form").serialize();location.assign(a.opts.URL+"&"+t)}),e(".page-first, .page-prev, .page-index, .page-next, .page-last").on("click",function(r){r.preventDefault();var t=location.search,i=e(this).attr("data-index");t?t.indexOf("page=")==-1?location.assign(a.opts.URL+"?"+t+"&page="+i):location.assign(a.opts.URL+"?"+t.replace(/(page=)\d+/,"$1"+i)):location.assign(a.opts.URL+"?page="+i)}),e(".order-cancel").on("click",function(a){a.preventDefault();var r={orderId:e(this).attr("data-id")};return"working"!=e(this).attr("working")&&(e(this).attr("working","working"),void e.post("/order/cancelOrder",r,function(a){e(this).attr("working",""),1==a.code?location.reload():alert(a.message||"取消订单失败, 请稍后重试")}))}),e(".order-delete").on("click",function(a){a.preventDefault();var r={orderId:e(this).attr("data-id")};return"working"!=e(this).attr("working")&&(e(this).attr("working","working"),void e.post("/order/deleteOrder",r,function(a){e(this).attr("working",""),1==a.code?location.reload():alert(a.message||"取消订单失败, 请稍后重试")}))}),e(".order-pay").on("click",function(r){r.preventDefault();var t={orderId:e(this).attr("data-id"),memberId:e(this).attr("data-member")};return"working"!=e(this).attr("working")&&(e(this).attr("working","working"),void e.post("/order/getOrderToPay",t,function(r){e(this).attr("working","");var i=r.data;1==r.code?(e("#zhifuModal").modal({backdrop:!1,show:!0}),e("#reservations_paid_orderSumCount").val(i.sumNums),e("#reservations_paid_orderSumPrice").val(i.originalPrice),e("#reservations_paid_payCount").val(i.sumNums),e("#reservations_paid_paySumPrice").val(i.originalPrice),e("#reservations_paid_money").val(i.originalPrice),a.queryMemberBalance(t.memberId)):alert(r.message||"查询订单支付失败, 请稍后重试")}))}),e(".reservations-pay-confirm").on("click",function(a){a.preventDefault(),e("#zhifuModal").modal("hide"),location.reload()})},queryMemberBalance:function(a){return a?void e.post("/member/memberDetail",{memberId:a},function(a){var r=a.data,t=e("#reservations_paid_money").val();1==a.code?(e("#reservations_paid_balance").val(r.cardBalance),r.cardBalance>=t?e("#reservations_paid_money").val("0.00"):e("#reservations_paid_money").val(t-r.cardBalance)):alert(a.message||"会员余额查询失败, 请稍后重试")}):void e("#reservations_paid_balance").val("0.00")},changePaidMoney:function(){e("#reservations_paid_paySumPrice").on("change",function(a){a.preventDefault();var r=e("#reservations_paid_balance").val(),t=e(this).val();r=parseFloat(r).toFixed(2),t=parseFloat(t).toFixed(2),r>=t?e("#reservations_paid_money").val("0.00"):e("#reservations_paid_money").val(t-r)})}};a.init()}(jQuery);