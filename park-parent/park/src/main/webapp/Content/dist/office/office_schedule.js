!function(e){var t={opts:{URL:"/office/schedule"},init:function(){e.datetimepicker.setLocale("zh"),e("#createTimeStart").datetimepicker({timepicker:!1,lang:"zh",format:"Y-m-d"}),e("#createTimeEnd").datetimepicker({timepicker:!1,lang:"zh",format:"Y-m-d"}),e("#user_schedule_date").datetimepicker({timepicker:!1,lang:"zh",format:"Y-m-d",defaultDate:new Date,minDate:0}),e("#user_schedule_start").datetimepicker({datepicker:!1,format:"H:i",step:30,value:"08:00"}),e("#user_schedule_end").datetimepicker({datepicker:!1,format:"H:i",step:30,value:"22:00"}),this.initEvents()},initEvents:function(){function t(t){e("#schedule_modal").find("#user_schedule_id").val(t.schedulingId||""),e("#schedule_modal").find("#user_schedule_date").val(t.date||""),e("#schedule_modal").find("#user_schedule_start").val(t.startTime||""),e("#schedule_modal").find("#user_schedule_end").val(t.endTime||""),e("#schedule_modal").find("#user_schedule_operator").val(t.operatorId||""),e("#schedule_modal").find("#user_schedule_job").val(t.schedulingJob||""),t.schedulingId?e("#user_schedule_delete").show():e("#user_schedule_delete").hide()}var i=this;e(".data-filter").on("click",function(t){t.preventDefault();var d=e("#data_form").serialize();location.assign(i.opts.URL+"?"+d)}),e(".add-schedule").on("click",function(e){e.preventDefault(),t({})}),e(".edit-schedule").on("click",function(i){i.preventDefault();var d=e(this).attr("data-id");e.post("office/scheduleInfo",{schedulingId:d},function(i){var d=i.data;1==i.code?t(d):(e.logConsole("查询值班详情失败",i.message),e.tipsWarningAlert("查询值班详情失败"))})}),e("#user_schedule_submit").on("click",function(t){t.preventDefault();var i=e("#user_schedule_form"),d=i.serialize();return!("submitting"===i.attr("submitting")||!i.valid())&&(i.attr("submitting","submitting"),void e.post("office/saveSchedule",d,function(t){i.attr("submitting",""),1==t.code?e.tipsSuccessAlert("值班信息提交成功！",function(){location.reload()}):(e.logConsole("值班信息保存失败",t.message),e.tipsWarningAlert("值班信息保存失败"))}))}),e("#user_schedule_delete").on("click",function(t){t.preventDefault(),e.post("office/deleteSchedule",{schedulingId:e("#user_schedule_id").val()},function(t){1==t.code?location.reload():(e.logConsole("值班信息删除失败",t.message),e.tipsWarningAlert("值班信息删除失败"))})}),e(".schedule-day").on("click",".panel-heading",function(t){t.preventDefault();var i=e(this),d=i.parents(".schedule-day");d.find(".schedule-list").is(":hidden")?d.find(".schedule-list").show():d.find(".schedule-list").hide()})}};t.init()}(jQuery);