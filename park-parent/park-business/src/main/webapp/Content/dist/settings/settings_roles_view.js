!function(e){var t={init:function(){this.initEvents(),this.initTree()},initTree:function(){e.post("/system/getAllRoles",{},function(t){var i={id:"0",text:"全部权限",state:{opened:!0,selected:!1},children:[]};1==t.code&&(i.children=t.data.roleMenuList),e("#role_tree").jstree({plugins:["wholerow","checkbox"],core:{data:[i]}}),setTimeout(function(){e("#role_tree").jstree("select_node",e('[name="menuIds"]').val().split(","))},1500)})},initEvents:function(){e(".roles-save").on("click",function(t){t.preventDefault();var i=e("#roles_form"),n=i.serializeObject();return n.limit=e("#role_tree").jstree("get_selected"),!("submitting"==i.attr("submitting")||!i.valid())&&(0===n.limit.length?(alert("请选择权限"),!1):(i.attr("submitting","submitting"),n.menuIds=n.limit.join(","),delete n.limit,void e.post("/settings/saveRole",n,function(t){i.attr("submitting",""),1==t.code?(e("#tips_modal").modal({show:!0,backdrop:!1}),setTimeout(function(){e("#tips_modal").modal("hide"),location.assign("/settings/getRoles")},2e3)):(console.log(t.message||"员工权限设置失败, 请稍后重试"),alert(t.message||"员工权限设置失败, 请稍后重试"))})))})}};t.init()}(jQuery);