!function(e){var a={init:function(){e.datetimepicker.setLocale("zh"),e("#createTimeStart").datetimepicker({timepicker:!1,lang:"zh",format:"Y-m-d",defaultDate:new Date,maxDate:0}),e("#createTimeEnd").datetimepicker({timepicker:!1,lang:"zh",format:"Y-m-d",defaultDate:new Date,maxDate:0}),this.initEvents()},getMealsOrderToday:function(a){e.post("/order/getMealsOrderToday",{memberId:a},function(a){var t=a.data;1==a.code&&t&&t.orders&&t.orders.length?(e("#teacher_meal_orderId").val(t.orders[0].orderId),e("#teacher_meal_orderNo").val(t.orders[0].orderNo)):(e("#teacher_meal_orderId").val(""),e("#teacher_meal_orderNo").val(""),alert("对不起，您今天没有预订场地，无法订餐"))})},initEvents:function(){var a=this;e("#teacher_meal_mealOpName").autosuggest({url:"/member/searchMember",method:"post",queryParamName:"search",dataCallback:function(a){var t=a.data,r=[];if(1==a.code){if(t&&t.members&&t.members.length>0){for(var l=0;l<t.members.length;l++)r.push({id:t.members[l].memberMobile,label:t.members[l].memberId,value:t.members[l].memberName+"("+t.members[l].cardTypeName+")"});return r}return e("#teacher_meal_memberId").val("0"),e("#teacher_meal_mealOpName").val(""),e("#teacher_meal_mealOpMobile").val(""),e("#teacher_meal_orderNo").val(""),[]}return alert("搜索会员失败, 请稍后重试"),[]},onSelect:function(t){var r=t.data("label"),l=t.data("id"),m=t.data("value");e("#teacher_meal_memberId").val(r),e("#teacher_meal_mealOpMobile").val(l),e("#teacher_meal_mealOpName").val(m.replace(/\(.+\)/,"")),a.getMealsOrderToday(r)}}),e("#teacher_meal_confirm").on("click",function(a){a.preventDefault();var t=e("#teacher_meal_form"),r=t.serialize();return!("submitting"==t.attr("submitting")||!t.valid())&&(t.attr("submitting","submitting"),void e.post("/site/saveMeal",r,function(a){t.attr("submitting",""),1==a.code?(e("#tips_success_modal").modal({backdrop:!1,show:!0}),setTimeout(function(){e("#tips_success_modal").modal("hide"),location.reload()},3e3)):(console.log(a.message||"订餐信息保存失败, 请稍后重试"),alert(a.message||"订餐信息保存失败, 请稍后重试"))}))}),e(".teachers-meals-list").on("click",".teachers-delete",function(){var a=e(this);e("#delete_teacherId").val(a.attr("data-id")),e("#tips_delete_modal").modal({backdrop:!1,show:!0})}),e("#tips_delete_modal .confirm-delete").on("click",function(a){a.preventDefault();var t=e("#delete_teacherId").val();e.post("/site/deleteMeal",{mealId:t},function(e){1==e.code?location.reload():(console.log(e.message||"订餐信息删除失败, 请稍后重试"),alert(e.message||"订餐信息删除失败, 请稍后重试"))})})}};a.init()}(jQuery);